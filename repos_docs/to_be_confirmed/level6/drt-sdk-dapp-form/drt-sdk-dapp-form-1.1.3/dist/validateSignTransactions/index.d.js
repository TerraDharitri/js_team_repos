"use strict";import{a as C,b as E,c as M,d as j,e as R}from"../__chunks__/chunk-DX3RVMAY.js";import"../__chunks__/chunk-ZPKQY6W4.js";import"../__chunks__/chunk-ZHGAGLK6.js";import"../__chunks__/chunk-VOOI3LEY.js";import"../__chunks__/chunk-YNDEUJMY.js";import{a as A}from"../__chunks__/chunk-UOIBDSBV.js";import"../__chunks__/chunk-4GIZ3VSZ.js";import"../__chunks__/chunk-53QEV2V5.js";import"../__chunks__/chunk-RLK5F7MS.js";import"../__chunks__/chunk-72LY5S2T.js";import"../__chunks__/chunk-53PJTHC3.js";import"../__chunks__/chunk-GF5V3HEJ.js";import"../__chunks__/chunk-OCXGRC37.js";import"../__chunks__/chunk-MCDVLP7Z.js";import"../__chunks__/chunk-XQ24TD7U.js";import"../__chunks__/chunk-PPMFFMVD.js";import"../__chunks__/chunk-FSVRGQVF.js";import"../__chunks__/chunk-YRCBIHIJ.js";import"../__chunks__/chunk-64SIVIRO.js";import"../__chunks__/chunk-Y5MTJSMF.js";import"../__chunks__/chunk-ANZEACB2.js";import"../__chunks__/chunk-EWJSLEUQ.js";import"../__chunks__/chunk-TPFP64W5.js";import"../__chunks__/chunk-4FTT4OE3.js";import"../__chunks__/chunk-AAYQACBH.js";import"../__chunks__/chunk-66CSTP6W.js";import"../__chunks__/chunk-5XSJARFM.js";import"../__chunks__/chunk-5PSWSTZ7.js";import"../__chunks__/chunk-BXMKJC34.js";import"../__chunks__/chunk-TBD3TB4W.js";import"../__chunks__/chunk-AMBNF44X.js";import"../__chunks__/chunk-DEDEX7XL.js";import"../__chunks__/chunk-6OVRUOBQ.js";import"../__chunks__/chunk-IYJRFSXF.js";import{c as B,e as F}from"../__chunks__/chunk-HUXM7W5S.js";import{c as L}from"../__chunks__/chunk-MEB4XTPU.js";import"../__chunks__/chunk-LJSWLAUQ.js";import"../__chunks__/chunk-FEKYKXOC.js";import"../__chunks__/chunk-RDE23DWT.js";import"../__chunks__/chunk-SABWITOR.js";import"../__chunks__/chunk-QX6I723V.js";import"../__chunks__/chunk-MNTXIFIK.js";import"../__chunks__/chunk-ETAPWUE5.js";import"../__chunks__/chunk-EJ3ZTZEO.js";import"../__chunks__/chunk-2VUZKG2R.js";import"../__chunks__/chunk-FUSY7N5I.js";import"../__chunks__/chunk-33YJQZRM.js";import"../__chunks__/chunk-TVLOP5ZM.js";import"../__chunks__/chunk-H5PSEE4B.js";import"../__chunks__/chunk-K2ANZTWJ.js";import"../__chunks__/chunk-DELJTN2D.js";import"../__chunks__/chunk-E43X7VZ4.js";import"../__chunks__/chunk-LQ5GJBXS.js";import"../__chunks__/chunk-YX6CD6DK.js";import"../__chunks__/chunk-65EH2VB7.js";import"../__chunks__/chunk-23YPEOPR.js";import"../__chunks__/chunk-ZRCRVYAC.js";import{a as n,b as c,g as b,i as d}from"../__chunks__/chunk-BL7T5FXS.js";import{f as m}from"../__chunks__/chunk-RGFNPOTZ.js";m();m();m();m();import{addressIsValid as N}from"@terradharitri/sdk-dapp/utils/account/addressIsValid";d();function Q({address:p,tx:o}){let e=F(String(o.data))&&!N(String(o.receiver))?p:String(o.receiver);return c(n({},o),{receiver:e})}var D=Q;import{Address as W}from"@terradharitri/sdk-core";import{isContract as V}from"@terradharitri/sdk-dapp/utils/smartContracts";d();function Y({transactions:p,txsDataTokens:o,isMainnet:e,address:r,whitelistedReceivers:a=[]}){if(e)try{let s=p.map(t=>D({address:r,tx:t})),x=s.length===0||s.every(({receiver:t})=>t===r||V(t)||a.includes(t)),f=o?Object.values(o).filter(({receiver:t})=>Boolean(t)).map(({receiver:t})=>new W(t).bech32()):[],i=f.length>0?f.every(t=>{let l=Boolean(t)&&a.includes(t);return t==null||t===r||V(t)||l}):!0;return x&&i}catch(s){return console.error("Unable to check whitelisted receivers",s),!1}else return!0}m();m();m();d();var q=p=>b(void 0,[p],function*({tx:o,txsDataTokens:e,rewaLabel:r,address:a,balance:s,chainId:x,ledger:f,apiConfig:i}){let u=o.transaction.getData().toString(),t=String(u||o.multiTxData),{amount:l,tokenId:g,type:y,receiver:G,nonce:H}=M({txsDataTokens:e,dataId:t,rewaLabel:r}),h=yield j({type:String(y),nonce:String(H),address:a,amount:l,receiver:G,tokenId:g,data:u},i),J=C({type:y,rewaLabel:r,tokenId:g,nftFound:Boolean(h)}),{tokenData:w,tokenAmount:O,tokenFound:P}=yield R({tokenId:J,parsedTokenAmount:l},i),U=E({tx:o,tokenId:g,rewaLabel:r,tokenFound:P,tokenAmount:O}),S={};try{let I=c(n({},U),{txType:L({nft:h==null?void 0:h.nft,tokenId:g}),address:a,balance:s,chainId:x,ignoreTokenBalance:!0,nft:h==null?void 0:h.nft,tokens:w?[w]:[],ledger:f});B(A).validateSync(I)}catch(I){let{path:X,message:K}=I;S={[String(X)]:String(K)}}return S});import{newTransaction as z}from"@terradharitri/sdk-dapp/models/newTransaction";import{getTokenFromData as Z}from"@terradharitri/sdk-dapp/utils/transactions/getTokenFromData";import{parseMultiDcdtTransferData as _}from"@terradharitri/sdk-dapp/utils/transactions/parseMultiDcdtTransferData";d();function $(p){let{transaction:o,transactionIndex:e,trx:r}=p;return{newTx:c(n({},o),{transaction:z(o),multiTxData:r.data,transactionIndex:e}),txsData:{[r.data]:{tokenId:r.token||"",amount:r.amount||"",type:r.type,nonce:r.nonce||"",multiTxData:r.data,receiver:r.receiver}}}}function tt(p){let{extractedTxs:o,address:e,chainId:r}=p,a={},s=[];return o.forEach((x,f)=>{let i=D({address:e,tx:x}),u=_(i.data);if(u.length>0)u.forEach(t=>{let{newTx:l,txsData:g}=$({trx:t,transaction:i,transactionIndex:f});a=n(n({},a),g),s.push(l)});else{let{tokenId:t,amount:l}=Z(i.data);t&&i.data&&(a=c(n({},a),{[i.data]:{tokenId:t,amount:l,receiver:i.receiver}})),s.push(c(n({},i),{transactionIndex:f,transaction:z(c(n({},i),{chainID:r}))}))}}),{allTransactions:s,txsDataTokens:a}}function rt(p){return b(this,null,function*(){let{address:o,rewaLabel:e,balance:r,chainId:a,apiConfig:s,allTransactions:x,txsDataTokens:f}=p,i={},u=x.map(l=>q({tx:l,txsDataTokens:f,address:o,rewaLabel:e,balance:r,chainId:a,apiConfig:s})),t=yield Promise.all(u);for(let l of t)i=n(n({},i),l);return i})}function ot(p){return b(this,null,function*(){let{extractedTxs:o}=p;if(o&&o.length>0){let{allTransactions:e,txsDataTokens:r}=tt(p),a=yield rt(c(n({},p),{allTransactions:e,txsDataTokens:r}));return{txsDataTokens:r,errors:a,parsedTransactions:e}}return null})}m();d();export{Y as validateReceivers,ot as validateSignTransactions};
//# sourceMappingURL=index.d.js.map
