import{a as H,b,c as K,d as w}from"./chunk-FEKYKXOC.js";import{a as J}from"./chunk-RDE23DWT.js";import{a as z}from"./chunk-EJ3ZTZEO.js";import{a as E}from"./chunk-H5PSEE4B.js";import{b as q,c as M,d as V,e as Y,f as X,g as j,h as d}from"./chunk-65EH2VB7.js";import{a as _,b as B,g as P,h as x,i as n}from"./chunk-BL7T5FXS.js";import{f as o}from"./chunk-RGFNPOTZ.js";o();import{DIGITS as sr,DECIMALS as mr,GAS_PRICE as dr}from"@terradharitri/sdk-dapp/constants/index";import lr from"bignumber.js";n();var Q,rr,ar,ur=b({input:String((Q=dr)!=null?Q:1e9),decimals:(rr=mr)!=null?rr:18,showLastNonZeroDecimal:!0,digits:(ar=sr)!=null?ar:4}),qr=new lr(ur).times(10).toString(10);o();import{getIdentifierType as cr}from"@terradharitri/sdk-dapp/utils/validation/getIdentifierType";n();function zr({nft:r,tokenId:t}){let{isDcdt:a,isNft:i,isRewa:e}=cr(t);return e?"REWA":(r==null?void 0:r.type)===E.NonFungibleDCDT?"NonFungibleDCDT":(r==null?void 0:r.type)===E.SemiFungibleDCDT?"SemiFungibleDCDT":(r==null?void 0:r.type)===E.MetaDCDT||i?"MetaDCDT":a?"DCDT":"REWA"}o();import{DECIMALS as fr}from"@terradharitri/sdk-dapp/constants/index";n();function pr({tokens:r,tokenId:t}){let a=r.find(({identifier:s})=>s===t),i=a?a.decimals:fr,e=(a==null?void 0:a.balance)||d;return B(_({},a),{decimals:i,identifier:(a==null?void 0:a.identifier)||"",name:(a==null?void 0:a.name)||"",ticker:(a==null?void 0:a.ticker)||"",balance:e})}var tr=pr;o();n();function k(r){return isNaN(Number(r))||r===""?w("0"):w(r)}o();import{EXTRA_GAS_LIMIT_GUARDED_TX as gr}from"@terradharitri/sdk-dapp/constants/index";n();function A(r=!1){return r?gr:0}o();import{GAS_LIMIT as vr,GAS_PER_DATA_BYTE as Sr}from"@terradharitri/sdk-dapp/constants/index";import er from"bignumber.js";n();var y=({data:r,isGuarded:t})=>{let a=new er(vr),i=new er(Sr),e=r?i.times(x.Buffer.from(r).length):0,s=A(t);return a.plus(e).plus(s).toString(10)};o();import{GAS_PER_DATA_BYTE as Tr}from"@terradharitri/sdk-dapp/constants/index";n();var R=(r="")=>{let t=V+r.length*Tr;return r.startsWith("DCDTNFTBurn")?X.toString():String(Math.max(t,Y))};o();o();import{Transaction as Ir,TransactionPayload as Dr,TransactionVersion as hr,Address as ir,TokenPayment as Lr}from"@terradharitri/sdk-core";import{VERSION as br}from"@terradharitri/sdk-dapp/constants/index";import wr from"bignumber.js";n();function U({amount:r,data:t,nonce:a,receiver:i,receiverUsername:e,sender:s,senderUsername:p,gasPrice:g,gasLimit:v,chainId:l}){let m=new wr(w(r));return new Ir({nonce:a,value:Lr.rewaFromBigInteger(m.toString(10)),sender:new ir(s),receiver:new ir(i),gasPrice:parseInt(g),gasLimit:parseInt(v),senderUsername:p,receiverUsername:e,data:new Dr(t),chainID:l,version:new hr(br)})}import Gr from"bignumber.js";import{GAS_LIMIT as Er}from"@terradharitri/sdk-dapp/constants/index";import{isContract as Ar}from"@terradharitri/sdk-dapp/utils/smartContracts";import{getIdentifierType as Cr}from"@terradharitri/sdk-dapp/utils/validation/getIdentifierType";import C from"bignumber.js";n();n();n();var Ma=r=>P(void 0,[r],function*({computedTokenId:t,receiver:a,isInternal:i,balance:e,address:s,isGuarded:p,nonce:g,amount:v,data:l,gasLimit:m,gasPrice:D,delegationContractData:S,chainId:h}){var G;let I=A(p),T=S==null?void 0:S.delegationContract,$=(G=S==null?void 0:S.delegationContractData.minGasLimit)!=null?G:d;if(!new C(m).isNaN()&&new C(m).isGreaterThan(d))return{initGasLimit:m};if(Ar(a)&&!i){let{gasLimit:N,gasLimitCostError:or}=yield xr({balance:e,address:s,nonce:g,values:{amount:v,receiver:a,data:l,gasLimit:m,gasPrice:D},chainId:h});return{initGasLimit:a===T?new C(N).plus($).plus(I).toString():N,initGasLimitError:or}}if(l.length>0)return{initGasLimit:y({data:l.trim(),isGuarded:p})};let{isDcdt:L,isNft:Z}=Cr(t);return L?{initGasLimit:new C(M).plus(I).toString()}:Z?{initGasLimit:new C(R()).plus(I).toString()}:{initGasLimit:new C(Er).plus(I).toString()}}),Pr=r=>P(void 0,[r],function*({balance:t,address:a,isGuarded:i,nonce:e,values:s,chainId:p}){var g,v,l;let{amount:m,receiver:D,data:S,gasLimit:h,gasPrice:G}=s,I=U({balance:t,amount:String(m),gasLimit:String(h),gasPrice:k(G),data:S.trim(),receiver:D,sender:a,nonce:e,chainId:p}).toPlainObject(),{data:T,success:$}=yield z(B(_({},I),{sender:a})),L=Number((g=T==null?void 0:T.data)==null?void 0:g.txGasUnits),Z=(v=T==null?void 0:T.data)==null?void 0:v.returnMessage;if(!Boolean($&&(T==null?void 0:T.code)==="successful"&&L&&L!==0))return{gasLimit:h,gasLimitCostError:(l=T==null?void 0:T.data)==null?void 0:l.returnMessage};if(!Z)return{gasLimit:new Gr(L).times(q).dividedToIntegerBy(100).plus(L).toString(10)};let N=y({data:s.data?s.data.trim():"",isGuarded:i});return{gasLimit:String(L)===d?N:String(L)}}),xr=Pr;o();import yr from"bignumber.js";n();function Wa({txType:r,data:t="",isGuarded:a}){let i=A(a),e=R();return r==="DCDT"&&(e=M),r==="REWA"&&(e=y({data:t.trim()})),new yr(e).plus(i).toString(10)}o();import W from"bignumber.js";n();var F=r=>r.length%2===0?r:`0${r}`,Nr=({amount:r,decimals:t,tokenId:a})=>{let i=Boolean(r)?r:d,e=F(x.Buffer.from(a).toString("hex")),s=F(new W(w(i,t)).toString(16));return`DCDTTransfer@${e}@${s}`},_r=({nft:r,amount:t,receiver:a,errors:i})=>{if(!(r&&t&&a&&!i))return"";try{let e="DCDTNFTTransfer",s=(r==null?void 0:r.type)===E.MetaDCDT?w(t,r.decimals):t;return e+=`@${x.Buffer.from(String(r.collection)).toString("hex")}`,e+=`@${F(new W(String(r.nonce)).toString(16))}`,e+=`@${F(new W(s).toString(16))}`,e+=`@${J.decode(a)}`,e}catch(e){return""}},Ja=({txType:r,values:t,nft:a,amountError:i,receiverError:e})=>{let{tokens:s,tokenId:p,amount:g,receiver:v}=t;if(s&&r==="DCDT"&&!i){let{decimals:l}=tr({tokens:s,tokenId:p});return Nr({amount:g,tokenId:p,decimals:l})}return r!=="REWA"?_r({nft:a,amount:g,receiver:v,errors:Boolean(i||e)}):t.data};o();import{GAS_PER_DATA_BYTE as Br,GAS_PRICE_MODIFIER as Mr,DECIMALS as kr,DIGITS as Rr}from"@terradharitri/sdk-dapp/constants/index";import O from"bignumber.js";n();function nt({balance:r=d,gasLimit:t=d,gasPrice:a,decimals:i,digits:e,data:s="",chainId:p}){let g=new O(r),v=new O(j),l=new O(H({gasPrice:a,gasLimit:t,data:s,chainId:p,gasPerDataByte:String(Br),gasPriceModifier:String(Mr)})),m=g.minus(l),D=m.minus(v),S=m.isGreaterThanOrEqualTo(0)?b({input:m.toString(10),decimals:i,digits:e,showLastNonZeroDecimal:!0,addCommas:!1}):d,h=D.isGreaterThanOrEqualTo(0)?b({input:D.toString(10),decimals:i,digits:e,showLastNonZeroDecimal:!0,addCommas:!1}):S;return{entireBalance:S,entireBalanceMinusDust:h,parsedEntireBalance:m.isGreaterThan(0)?m.toString(10):d}}function ot({balance:r=d,decimals:t=kr,digits:a=Rr}){let i=new O(r);if(i.isGreaterThanOrEqualTo(0)){let e=i.toString(10);return b({input:e,decimals:t,digits:a>t?t:a,showLastNonZeroDecimal:!0,addCommas:!1})}return d}o();n();function ut(r){return P(this,null,function*(){let{address:t,balance:a,chainId:i,nonce:e,values:s}=r,{amount:p,receiver:g,data:v,gasLimit:l,gasPrice:m,nft:D,receiverUsername:S,senderUsername:h}=s,G=Boolean(D)?t:g;try{return U({balance:a,amount:String(p),gasLimit:String(l),gasPrice:k(m),data:v.trim(),receiver:G,receiverUsername:S,senderUsername:h,sender:t,nonce:e,chainId:i})}catch(I){throw console.log("Prepare transaction error",I),I}})}o();import{stringIsInteger as Ur}from"@terradharitri/sdk-dapp/utils/validation/stringIsInteger";n();var gt=({count:r,maxCount:t})=>{if(r!==void 0&&Ur(r.toString())){let a=t%r>0?1:0;return Array.from(Array(Math.floor(r/t)+a).keys()).filter(i=>i!==0).map(i=>i+1)}else return[]};o();import{DECIMALS as Fr,DIGITS as nr}from"@terradharitri/sdk-dapp/constants/index";n();function Dt({feeLimit:r,rewaPriceInUsd:t}){let a=b({input:r,decimals:Fr,digits:nr,showLastNonZeroDecimal:!0});return`\u2248 ${K({amount:a,usd:t,decimals:nr})}`}export{ur as a,qr as b,zr as c,pr as d,tr as e,k as f,A as g,y as h,R as i,Ma as j,Pr as k,Wa as l,Nr as m,_r as n,Ja as o,nt as p,ot as q,ut as r,gt as s,Dt as t};
//# sourceMappingURL=chunk-MEB4XTPU.js.map
